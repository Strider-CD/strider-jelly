<div id = "#custom" class="tab-pane widget">
  <style>
   .script textarea{
      height:100px; width:54em; font-family:monospace;
      background-color:#111; color:#9f9; 
      padding:1em;
      resize:vertical;
    }
  .affix{position:fixed; top:180px; right:200px;}
  </style>
  <div class='span8'>
    <h2>Add Jelly-Proxy Shim</h2>
    <hr />

    <div class='control-group'>
      <label class='control-label'  for="qunit_path">URL of test content</label>
      <div class='controls'>
        <input type='text' id = "qunit_path" name = "path" placeholder="http://localhost:8000/test.html" />
      </div>
    </div>
    <div class='control-group'>
      <label class='control-label'  for="qunit_path">Port on which Jelly-Proxy listens</label>
      <div class='controls'>
        <input type='text' id = "qunit_path" name = "path" placeholder="1077" />
      </div>
    </div>

    <div class='well script'>    
      <h4>Create Javascript Shim Payload</h4>
      <p>This code is inserted before the end body tag of all pages proxied through jelly-proxy</p>
      <textarea id = "prepare" spellcheck="false" name ='payload' placeholder =";(function(){})();"></textarea>
      <h5>Note:</h5>
      <p>You can 'phone home' to strider with ajax - the following urls correspond to plugin events:</p>
      <ul>
        <li>/_jelly/progress   :  'progress' </li>
        <li>/_jelly/results    :  'testDone' </li>
      </ul>
    </div>
  </div>
  <div class='savecode affix' data-spy="affix" data-offset-top="20">
      <a id = "savecodebtn" href = "javascript://" class='btn btn-primary btn-large'>Save</a>
    </div>
  <script>
 
$(function(){
  var repo = $("html").data().controllerParams.repo_url; // EWW!
/*
  $.getJSON("/custom/script", {url: repo}, function(res){
    $.each(['prepare', 'test', 'deploy', 'cleanup'], function(){
      var phase = this + ''
      $("#" + phase).val(res.results[phase] || '');
    })

  })


  $("#savecodebtn").click(function(){
    var out = {}

    $.each(['prepare', 'test', 'deploy', 'cleanup'], function(){
      var phase = this + ''
        , code = $("#" + phase).val();
      out[phase] = code;
    })

    $.post('/custom/script', {url:repo, scripts:out}, function(res){
      if(res.errors) throw res.errors;
      alert("Saved!")
    })

  })  
  */
})

  </script>

</div>
